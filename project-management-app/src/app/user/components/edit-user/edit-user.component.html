<h2>Edit user:</h2>
<div class="container">
  <!-- <div class="spinner-container" *ngIf="isLoading">
    <app-loading-spinner></app-loading-spinner>
  </div> -->
  <form class="edit-form" [formGroup]="editForm" (ngSubmit)="onSaveChanges()">
    <mat-form-field class="edit-field" floatLabel="auto" appearance="outline">
      <mat-label class="edit-label">First Name</mat-label>
      <input
        type="text"
        id="first-name"
        formControlName="firstName"
        matInput
        name="first-name"
        placeholder="First Name"
      />
      <mat-error
        *ngIf="
          validationService.hasError(editForm, 'firstName', 'required') &&
          editForm.get('firstName')?.touched
        "
        >Please enter a first name</mat-error
      >
      <mat-error
        *ngIf="
          validationService.hasError(editForm, 'firstName', 'minlength') &&
          editForm.get('firstName')?.touched
        "
        >Min length 3 characters</mat-error
      >
    </mat-form-field>
    <mat-form-field class="edit-field" floatLabel="auto" appearance="outline">
      <mat-label class="edit-label">Last Name</mat-label>
      <input
        type="text"
        id="last-name"
        formControlName="lastName"
        matInput
        name="last-name"
        placeholder="Last Name"
      />
      <mat-error
        *ngIf="
          validationService.hasError(editForm, 'lastName', 'required') &&
          editForm.get('firstName')?.touched
        "
        >Please enter a last name</mat-error
      >
      <mat-error
        *ngIf="
          validationService.hasError(editForm, 'lastName', 'minlength') &&
          editForm.get('firstName')?.touched
        "
        >Min length 3 characters</mat-error
      >
    </mat-form-field>
    <mat-form-field class="edit-field" floatLabel="auto" appearance="outline">
      <mat-label class="edit-label">Email</mat-label>
      <input
        type="email"
        id="email"
        formControlName="email"
        matInput
        name="email"
        placeholder="Email"
      />
      <mat-error
        *ngIf="
          validationService.hasError(editForm, 'email', 'required') &&
          editForm.get('email')?.touched
        "
        >Please enter a new login email</mat-error
      >
      <mat-error
        *ngIf="
          validationService.hasError(editForm, 'email', 'email') &&
          editForm.get('email')?.touched
        "
        >The login email is invalid</mat-error
      >
    </mat-form-field>
    <div class="hint">
      <p>
        Enter a new password. Enter the old one in case if you don't want to
        change it.
      </p>
    </div>
    <mat-form-field
      class="edit-field password-field"
      floatLabel="auto"
      appearance="outline"
    >
      <mat-label class="edit-label">Password</mat-label>
      <input
        [type]="hidePassword ? 'password' : 'text'"
        class="edit-input"
        id="password"
        formControlName="password"
        matInput
        placeholder="Password"
        name="password"
      />
      <mat-icon matSuffix (click)="hidePassword = !hidePassword">{{
        hidePassword ? 'visibility_off' : 'visibility'
      }}</mat-icon>
      <mat-hint align="start" class="password-hint"
        >Your password should include at least 1 uppercase character, lowercase
        character, number, special symbol and be at least 8 characters
        long</mat-hint
      >
      <mat-error
        *ngIf="validationService.hasError(editForm, 'password', 'required')"
        >Please enter a password</mat-error
      >
      <mat-error
        *ngIf="
          !editForm.get('password')?.valid && editForm.get('password')?.touched
        "
        >Your password isn't strong enough:
        <span
          class="err-span"
          *ngIf="validationService.passwordHasErrors(editForm) === 'uppercase'"
        >
          Password must contain at least 1 uppercase letter</span
        >
        <span
          class="err-span"
          *ngIf="validationService.passwordHasErrors(editForm) === 'lowercase'"
        >
          Password must contain at least 1 lowercase letter</span
        >
        <span
          class="err-span"
          *ngIf="validationService.passwordHasErrors(editForm) === 'number'"
        >
          Password must contain at least 1 number</span
        >
        <span
          class="err-span"
          *ngIf="
            validationService.passwordHasErrors(editForm) === 'specialChar'
          "
        >
          Password must contain at least 1 special character</span
        >
        <span
          class="err-span"
          *ngIf="validationService.passwordHasErrors(editForm) === 'length'"
        >
          Password must be at least 8 characters long</span
        >
      </mat-error>
    </mat-form-field>
    <div class="buttons-container">
      <button
        type="submit"
        mat-stroked-button
        color="primary"
        class="button save-button"
        [disabled]="!editForm.valid"
      >
        Save
      </button>
      <button
        type="button"
        mat-stroked-button
        color="danger"
        class="button delete-button danger-btn"
        (click)="onDeleteUser()"
      >
        Delete User
      </button>
    </div>
  </form>
</div>
